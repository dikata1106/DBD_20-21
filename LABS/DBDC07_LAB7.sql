CREATE TABLE PRODUCTO07 (
    ProductoID Number,
    ProductoNombre varchar2(20),
    Marca varchar2(20),
    primary key (ProductoID)
);
CREATE TABLE CLIENTE07 (
    ClienteID Number,
    NombreCliente varchar2(20),
    Empresa varchar2(20),
    primary key (ClienteID)
);
CREATE TABLE COMUNIDADAUTONOMA07 (
    ComunidadID Number,
    NombreComunidad varchar2(20),
    primary key (ComunidadID)
);
CREATE TABLE VENTAS07 (
    ProductoID Number,
    ClienteID Number,
    ComunidadID Number,
    Unidades Number,
    primary key (ProductoID, ClienteID, ComunidadID),
    Foreign key (ProductoID) REFERENCES PRODUCTO07(ProductoID),
    Foreign key (ClienteID) REFERENCES CLIENTE07(ClienteID),
    Foreign key (ComunidadID) REFERENCES COMUNIDADAUTONOMA07(ComunidadID)
);

INSERT INTO PRODUCTO07 VALUES(1111,'ProductoNombreA','marcaA');
INSERT INTO PRODUCTO07 VALUES(1112,'ProductoNombreB','marcaB');
INSERT INTO PRODUCTO07 VALUES(1113,'ProductoNombreC','marcaC');
INSERT INTO PRODUCTO07 VALUES(1114,'ProductoNombreD','marcaD');
INSERT INTO PRODUCTO07 VALUES(1115,'ProductoNombreE','marcaE');
INSERT INTO PRODUCTO07 VALUES(1116,'ProductoNombreF','marcaF');
INSERT INTO PRODUCTO07 VALUES(1117,'ProductoNombreG','marcaG');
INSERT INTO PRODUCTO07 VALUES(1118,'ProductoNombreH','marcaH');
INSERT INTO PRODUCTO07 VALUES(1119,'ProductoNombreI','marcaI');
INSERT INTO PRODUCTO07 VALUES(1120,'ProductoNombreJ','marcaJ');
INSERT INTO PRODUCTO07 VALUES(1121,'ProductoNombreK','marcaK');
INSERT INTO PRODUCTO07 VALUES(1122,'ProductoNombreL','marcaL');
INSERT INTO PRODUCTO07 VALUES(1123,'ProductoNombreM','marcaM');
INSERT INTO PRODUCTO07 VALUES(1124,'ProductoNombreN','marcaN');
INSERT INTO PRODUCTO07 VALUES(1125,'ProductoNombreÑ','marcaÑ');
INSERT INTO PRODUCTO07 VALUES(1126,'ProductoNombreO','marcaO');
INSERT INTO CLIENTE07 VALUES(1111,'Cliente11','Empresa11');
INSERT INTO CLIENTE07 VALUES(1112,'Cliente12','Empresa12');
INSERT INTO CLIENTE07 VALUES(1113,'Cliente13','Empresa13');
INSERT INTO CLIENTE07 VALUES(1114,'Cliente14','Empresa14');
INSERT INTO CLIENTE07 VALUES(1115,'Cliente15','Empresa15');
INSERT INTO CLIENTE07 VALUES(1116,'Cliente16','Empresa16');
INSERT INTO CLIENTE07 VALUES(1117,'Cliente17','Empresa17');
INSERT INTO CLIENTE07 VALUES(1118,'Cliente18','Empresa18');
INSERT INTO CLIENTE07 VALUES(1119,'Cliente19','Empresa19');
INSERT INTO CLIENTE07 VALUES(1120,'Cliente20','Empresa20');
INSERT INTO CLIENTE07 VALUES(1121,'Cliente21','Empresa21');
INSERT INTO CLIENTE07 VALUES(1122,'Cliente22','Empresa22');
INSERT INTO CLIENTE07 VALUES(1123,'Cliente23','Empresa23');
INSERT INTO CLIENTE07 VALUES(1124,'Cliente24','Empresa24');
INSERT INTO CLIENTE07 VALUES(1125,'Cliente25','Empresa25');
INSERT INTO CLIENTE07 VALUES(1126,'Cliente26','Empresa26');
INSERT INTO COMUNIDADAUTONOMA07 VALUES(1111,'comunidad11');
INSERT INTO COMUNIDADAUTONOMA07 VALUES(1112,'comunidad12');
INSERT INTO COMUNIDADAUTONOMA07 VALUES(1113,'comunidad13');
INSERT INTO COMUNIDADAUTONOMA07 VALUES(1114,'comunidad14');
INSERT INTO COMUNIDADAUTONOMA07 VALUES(1115,'comunidad15');
INSERT INTO COMUNIDADAUTONOMA07 VALUES(1116,'comunidad16');
INSERT INTO COMUNIDADAUTONOMA07 VALUES(1117,'comunidad17');
INSERT INTO COMUNIDADAUTONOMA07 VALUES(1118,'comunidad18');
INSERT INTO COMUNIDADAUTONOMA07 VALUES(1119,'comunidad19');
INSERT INTO COMUNIDADAUTONOMA07 VALUES(1120,'comunidad20');
INSERT INTO COMUNIDADAUTONOMA07 VALUES(1121,'comunidad21');
INSERT INTO COMUNIDADAUTONOMA07 VALUES(1122,'comunidad22');
INSERT INTO COMUNIDADAUTONOMA07 VALUES(1123,'comunidad23');
INSERT INTO COMUNIDADAUTONOMA07 VALUES(1124,'comunidad24');
INSERT INTO COMUNIDADAUTONOMA07 VALUES(1125,'comunidad25');
INSERT INTO COMUNIDADAUTONOMA07 VALUES(1126,'comunidad26');
INSERT INTO VENTAS07 VALUES(1111,1126,1112,2);
INSERT INTO VENTAS07 VALUES(1112,1125,1114,47);
INSERT INTO VENTAS07 VALUES(1113,1124,1116,53);
INSERT INTO VENTAS07 VALUES(1114,1123,1118,20);
INSERT INTO VENTAS07 VALUES(1115,1122,1120,13);
INSERT INTO VENTAS07 VALUES(1116,1121,1122,1);
INSERT INTO VENTAS07 VALUES(1117,1120,1124,22);
INSERT INTO VENTAS07 VALUES(1118,1119,1126,2);
INSERT INTO VENTAS07 VALUES(1119,1118,1111,45);
INSERT INTO VENTAS07 VALUES(1120,1117,1113,99);
INSERT INTO VENTAS07 VALUES(1121,1116,1115,11);
INSERT INTO VENTAS07 VALUES(1122,1115,1117,100);
INSERT INTO VENTAS07 VALUES(1123,1114,1119,11);
INSERT INTO VENTAS07 VALUES(1124,1113,1121,99);
INSERT INTO VENTAS07 VALUES(1125,1112,1123,2);
INSERT INTO VENTAS07 VALUES(1126,1111,1125,69);
COMMIT;

-- VISUALIZACION DE DATOS
SELECT * FROM CB$CUBO07;
SELECT CLIENTE, PRODUCTO, SUM(UNIDADES07)
FROM CB$CUBO07
GROUP BY ROLLUP (CLIENTE, PRODUCTO);